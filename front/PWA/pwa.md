### DO IT! 프로그레시브 웹앱 만들기 정리

## 앱 종류
- 네이티브 앱 (native app) : 스마트폰 운영체제에서만 작동하는 앱 
    - 운영체제별로 개발해야함
- 모바일 웹앱 : 브라우저로 통신해서 모든 단말기에서 똑같은 콘텐츠를 볼 수 있음 
    - 인터넷 환경에 따라 구동속도가 다르고, 기기 고유의 기능을 사용하는데 한계가 있음
- 하이브리드 앱 : 모바일 웹앱과 네이티브앱의 장점만 살림
    - 웹 표준 기술을 그대로 사용해 웹앱을 만듬
    - 별도의 프레임워크를 이용해 네이티브 앱으로 변환해서 배포
    - 개발은 모바일 웹앱처럼, 배포는 네이티브 앱처럼 함
- 프로그레시브 웹앱 : 모바일 웹앱처럼 쉽게 개발하고 네이티브 앱과 똑같은 사용자 경험을 제공하는것이 목표
    - 서비스 워커 
        - 웹 브라우저 안에 있지만 웹 페이지와는 분리되어 항상 실행되는 백그라운드 프로그램
        - 브라우저와 서버 상의 상탯값의 변경을 감시하고 푸시 알림으로 사용자에게 특정 메시지와 댓글 알림을 보냄
        - 오프라인 상태에서도 작동
    - 웹앱 매니페스트
        - 앱 소개 정보와 기본 설정을 담은 JSON 파일을 말함
        - PWA는 반드시 manifest.json이라는 파일 이름으로 웹앱 매니페스트를 포함해야 함
    - HTTPS
        - HTTP 프로토콜에 비해 암호화와 인증을 거쳐 보안을 강화한 웹 통신 규약
        - 서비스 워커를 이용해서 PWA를 배포할 때는 반드시 HTTPS 프로토콜을 사용해야 함
        - HTTPS 프로토콜은 라이트하우스 라는 PWA 성능 평가 프로그램에서 인증을 받기 위한 의무 사항
        - '홈 화면 추가' 기능은 HTTPS에서만 지원
    - 푸시 알림
        - 푸시 알림에 동의만 했다면 웹 사이트에 한 번 방문하고 떠난 사용자에게도 알림을 보낼 수 있음
        - PWA가 실행되지 않은 백그라운드 상태에서도 알림 메시지를 보낼 수 있음
    - 홈 화면에 추가 기능
        - PWA로 개발된 웹에 접속하면 웹 브라우저는 사용자에게 PWA를 설치하라고 스스로 제안
            - HTTPS 접속
            - 매니페스트 등록
            - 서비스 워커 설치
            - PWA 설치 여부
    - 사용자 경험
        - 오프라인과 온라인에서도 걱정 없는 '신뢰성'
        - 네이티브 앱보다 간단히 설치할 수 있는 '편리성'
        - 훨씬 강력해진 '보안성'
        - 단골 손님을 늘리는 '구독자 고객 관리'
        - 모든 곳에서 실행되는 '멀티 플랫폼' 지원
        - 검색에 잘 노출되고 잘 퍼지는 '확장성'
        - 항상 새것 같은 '최신성'
        - 네이티브 앱도 부럽지 않은 '사용성'
        - 네이티브 앱보다 빠른 '배포, 실행, 반응 속도'

## 모던 자바스크립트
- 블록 함수
    - 함수(선언식)
        - function 뒤에 함수 이름을 적음 
        - 소괄호() 안에 필요한 매개변수를 쉽표(,)로 구분해서 적음
        - 함수가 수행할 명령을 중괄호{}로 감싸서 구현
        - function 함수명(매개변수, 매개변수) {}
    - 함수(표현식)
        - 함수명 없이 선언한 후에 객체 변수에 저장
        - 변수명이 함수명이 되므로 이 함수를 호출할 때는 변수명을 이용
        - const 변수명 = function (매개변수, 매개변수) {}
    - 호이스팅 : 코드를 실행하기 전에 내부에서 변수와 함수의 위치를 맨 위로 옮겨 선언하는 자바스크립트의 문법적인 기능
        - 장점 : 변수나 함수를 좀 더 유연하게 사용할 수 있음
        - 단점 : 오류가 생기면 찾기 어려움
        - 함수 선언식은 호이스팅이 적용
        - 함수 표현식은 '선언 후 호출'이라는 순서를 엄격하게 지켜야 함
- 변수 선언
    - var 키워드
        - 함수 스코프만 지원하고 블록 스코프는 지원하지 않음
        - 함수 스코프는 유효 범위가 함수 내부이고 블록 스코프는 블록{} 내부
        - 디버깅이 어려움
    - let, const 키워드
        - 블록 스코프를 지원
        - 같은 이름으로 중복해서 선언할 수 없음
        - let : 변숫값을 언제든지 변경 가능
        - const : 한 번 값을 할당하면 바꿀 수 없음
- 화살표 함수
    - const 변수명 = (매개변수, 매개변수) => { return 매개변수 + 매개변수; }
    - const 변수명 = (매개변수, 매개변수) => 매개변수 + 매개변수;
    - const 함수명 = () => {};
- 모듈 내보내기와 가져오기
    - 모듈 : 코드를 관리하는 가장 작은 단위
    - 내보내기 
        - 이름으로 내보내기, 가져오기
            - 소스 파일에 선언된 식별자를 복수로 선택해 공유하는 방식
            - export 키워드를 작성한 다음에 공유하고 싶은 식별자를 쉼표로 나열해서 중괄호 {}로 감싸면 됨
            - export { 변수명, 상수명, 함수명, 클래스명}
            - import { 변수명, 상수명, 함수명, 클래스명} from 파일 위치
            - import * as 이름 from 파일 위치
        - 기본으로 내보내기
            - 소스 파일에 있는 식별자 중 하나를 대표로 지정해서 공유하는 방식
            - 모듈 하나당 하난의 함수나 클래스만 공유할 수 있음
            - var, let, const는 사용할 수 없음
            - export default (변수명, 상수명, 함수명, 클래스명)
            - import 변경된 이름 from 파일 위치
- 콜백 함수와 비동기 처리 방식
    - 동기, 비동기 처리
        - 동기 : 함수를 포함한 모든 코드가 위에서 아래로 순서대로 실행되는 것
            - 모든 코드가 위에서 아래 순서로 실행
            - 명령을 요청한 후 결과가 나올때까지 기다림
            - 반환 결과를 계속 기다리므로 시간 지연이 큼
        - 비동기 : 명령을 요청한 후 결과가 나오지 전에 다음 작업을 연이어 수행하고 결과가 완료되면 다시 돌아와 마무리
            - 코드들이 독립적으로 실행
            - 명령을 요청한 후 결과가 나올떄까지 기다리지 않고 다음 작업을 연이어 수행
            - 결과가 완료되면 다시 돌아와 필요한 것을 마무리
        - 콜백 함수로 비동기 처리 구현
            - 매개변수로 값 대신 함수를 전달
            - 콜백 함수 : 매개변수로 전달된 함수를 콜백 함수
            - 콜백 함수의 문제
                - 콜백 지옥 : 콜백 함수가 늘어나서 심하게 중첩
                - 반환값 처리 문제 : 반환값을 처리하는 시점이 분리되어 관리가 어려움
            - 문제 해결을 위해 Promise 등장
        - JSON
            - 자바스크립트에서 데이터를 저장하고 교환할 때 사용하는 정형화된 텍스트 형식으로 매우 간단한 것이 특징
            - 자바스크립트의 데이터 타입인 객체로 변환해서 사용
            - 최근에는 자바스크립트뿐만 아니라 거의 대부분의 프로그래밍 언어에서 서버와 브라우저 간에 데이터를 주고받는 형식으로 많이 사용
            - 시작과 끝은 중괄호({})로 지정하고, 각 항목은 '키:값' 형식으로 묶어서 표현, 각 항목은 콤마(,)로 구분
            - 텍스트를 객체로 바꿈 : JSON.parse()
            - 객체를 텍스트로 변환 : JSON.stringify()
        - Fetch API
            - 웹 API에서 제공하는 함수
            - 원격 서버에서 제공하는 데이터의 CRUD 작업을 손쉽게 하도록 HTTP Request, Response의 POST,GET,PUT,DELEte 메서드로 관리해주는 방법을 제공
            - fetch(데이터를 읽을 주소)
                - 반환값 : 서버가 응답하는 값을 Promise 객체로 변환
- Promise와 비동기 처리 방식
    - 비동기 처리방식으로 실행된 결과의 성공과 실패를 관리하는 객체
    - 성공 : resolved, 실패 : rejected, 이행 지연 : pending
    - 최종 성공 : fullfilled, 최종 실패 : unfullfilled
- await 연산자와 async 비동기 함수
    - await 
        - 다음 실행으로 넘어가지 않고 결과가 나올때까지 기다림
        - 오른쪽 항을 동기로 처리하도록 지시 
        - 단독으로 사용하면 결과가 나오지 않을 떄 무한 루프에 빠질수 있음
        - 비동기 방식으로 처리하는 명령이 있는 함수는 반드시 async를 실행

### PWA 만들어보기
- manifest.json
    - 유효성 검사 웹 사이트 : https://manifest-validator.appspot.com/
    - "name": "안녕하세요! PWA by JS", //바로가기 아이콘 설치를 권장하는 팝업 배너와 스플래시 스크리에 표시되는 제목
    - "short_name": "PWA by JS", //바탕화면 바로가기 아이콘 아래 표시되는 제목
    - "description": "PWA start program", //웹 크롤러에 수집되는 내용
    - "scope": ".", //매니페스트에 정의된 내용이 적용될 수 있는 파일들의 범위를 지정
    - "start_url": "./", //프로그램을 실행하면 시작될 URL
    - "display": "fullscreen", //PWA를 실행하면 나타나는 화면의 형태를 설정하는 속성
    - "orientation": "portrait", //화면의 방향을 결정하는 속성
    - "theme_color": "#ffffff", //상태표시줄의 생상을 설정
    - "background_color": "#ffffff", //스플래시 스크린의 배경색을 설정
    - "icons": [ //아이콘 이미지 중에서 128dpi에 가장 가까운 이미지를 찾아 화면에 표시
            {
            "src": "images/icons/android-chrome-512x512.png",
            "sizes": "512x512",
            "type": "image/png"
            }
        ]
- 워크박스
    - 서비스 워커를 이용한 오프라인 캐시 관리
    - 웹앱의 오프라인 기능을 지원하는 자바스크립트 라이브러리
    - 3가지 캐시 전략
        - 캐시가 필요한 경우
            - HTML, JS, CSS 파일
            - 글꼴, 아이콘 파일
            - 이미지 파일
            - HTTP 요청
        - Cache First
            - 캐시 먼저 사용 -> 캐시에 없으면 그때 온라인 사용
            - 캐시가 유용한 폰트, 이미지처럼 바뀔 가능성이 작을 때
            - 폰트, 이미지
        - Stale while revalidate
            - 캐시 먼저 사용 -> 캐시 내용이 변경되면 온라인에 접속해 변경된 것으로 교체
            - 캐시가 유용하지만 사용자가 가끔씩 변경할 때
            - 아바타 이미지, CSS, JS
        - Network First
            - 온라인에 먼저 접속해 사용 -> 오프라인일 때 캐시 사용
            - 인터넷 기사처럼 항상 최신 내용이 중요할 때
            - HTTP 요청 URL
- PWA와 워크박스
    - Vue-CLI의 PWA 템플릿은 워크박스를 기본으로 사용해서 캐시를 자동으로 제공
        - index.html, robots.txt
            - 첫 시작 HTML, 웹 크롤러 설정
            - /dist
        - *.css, *.js
            - CSS,JS 파일 캐시
            - /dist/css, /dist/js
        - *.png
            - 이미지 파일 캐시
            - /dist/img
        - index.html에서 사용한 외부 연결
            - 구글 폰트, 머티리얼 디자인 아이콘
- 파이어베이스
    - 실전에 사용할 수 있는 고품질 모바일 앱과 웹앱을 쉽고 빠르게 개발할 수 있도록 서버단에 필요한 다양한 기능을 클라우드 서비스로 지원하는 통합 플랫폼
- 워크박스로 오프라인 관리하기
    - 플러그인 모드
        - GenerateSW : 자동으로 생성되는 서비스 워커에 워크박스 옵션 지정
            - 프리캐시할 파일을 빠르게 지정해야 할 때
            - 간단한 런타임 캐시가 필요할 때
            - 한계 : 서비스 워커에 코드를 넣어야 할때, 웹 푸시 알림을 사용할 떄
        - InjectManifest : 서비스 워커에 자신의 코드를 직접 넣어 최종 서비스 워커 파일 생성
            - 서비스 워커에 자신의 코드를 넣어야 할 떄
            - 코드로 직접 프리캐시, 런타임 캐시를 지정하고 싶을 떄
            - 웹 푸시 알림을 사용하고 싶을 때
            - 한계 : 복잡해질 수 있으므로 간단할 때는 GenerateSW가 적합할 수 있음
    - 프리캐시
        - 캐시는 실행하기 전에 미리 지정    
        - 옵션
            - include
                - 프리캐시에서 사용할 파일을 지정
                - 파일 이름을 토대로 하므로 대량으로 찾는 정규식을 함께 활용하면 유용
                - ex) include: [/\.css$, /\.js$/]
            - exclude 
                - 프리캐시에서 제거할 파일을 지정
                - 사용법은 include처럼 정규식을 함께 활용
                - 유의할 점은 제거할 파일이 없어도 exlude:[]처럼 반드시 명시해줘야 함
                - ex) exclude: [/\.json$, /\.png$/]
    - 런타임 캐시
        - 프로그램이 실행할 때 원하는 부분만 지정
        - Network-First
            - 인터넷 접속을 먼저 요청
            - 접속에 성공하면 결과를 보여주고 그 내용을 캐시에 반영
            - 문제가 생기면 캐시에서 읽어서 화면에 표시
            - 인터넷 기사처럼 항상 새로운 내용이 필요할 때 적합
        - Cache-First
            - 캐시에 먼저 요청
            - 만약 내용이 있으면 성공적으로 결과를 보여 줌
            - 캐시에 내용이 없으면 인터넷에 접속하여 결과를 화면에 보여줌
            - 읽어온 내용은 캐시에 저장
            - 웹 사이트 전체에서 사용하는 폰트, 아이콘, 이미지처럼 바뀔일 이 거의 없는 파일에 적합
        - Stale-while-revalidate
            - 캐시에 먼저 요청한 후 내용이 있으면 성공적으로 결과를 보여줌
            - 동시에 서비스 워커는 인터넷에 접속하여 캐시된 내용이 원본과 같은지 확인
            - 다르면 캐시를 새로운 원본으로 업데이트
            - 인터넷의 내용이 다른 내용으로 바뀌어도 캐시의 내용 또한 항상 최신 정보로 유지
            - Cache-First의 장점을 사용하면서 업데이트가 가끔 발생할 때 적용하면 좋음
        - Network-Only
            - 필요한 파일이 있으면 무조건 인터넷에 접속해서 가져오는 방식
            - 데이터 변경이 빈번해서 캐시를 이용하는 의미가 없을 때 사용
        - Cache-Only
            - 필요한 파일이 있으면 무조건 캐시에서 가져오는 방법
            - 데이터 변경이 전혀 없고 오프라인 작업만으로 실행할 수 있을 때 사용
        - 런타임 캐시 옵션 지정
            - 앱을 실행할 때 외부 HTTPS 요청 등에 의해 발생되는 파일들을 캐시하는것
            - 설정하고 싶은 옵션 내용을 runtimeCaching 속성에 산 번에 하나씩 쉼표(,)로 구분해서 작성
            - ex) runtimeCaching: [{설정 옵션1},{설정 옵션2},{설정 옵션3}]
- 푸시알림 서비스
    - 푸시 알림 : 공지가 필요한 메시지를 발송하여 사용자가 모바일 기기에서 확인 할 수 있는 서비스
    - 공개 키와 비공개 키
        - 공개 키와 비공개 키는 하나의 쌍으로 생성되며 인증받은 사용자만 중요한 데이터에 접근할 수 있음
        - 공개 키는 일반적으로 신뢰할 수 있는 기관에 제공하며 열려 있으므로 누구나 열람하고 사용할 수 있음
        - 비공개 키는 암호화된 데이터를 해독할 때 공개 키와 함께 사용해야 함, 외부에 유출되면 안됨
        - 공개 키가 있다는 것은 신뢰할 만한 외부 기관에 데이터를 보관하고 있다는 의미
        - 비공개 키가 있다는 것은 데이터를 소유한 주인이라는 의미
        - 공개 키와 비공개 키를 함께 사용한다는 것은 데이터의 주인이 신뢰할 만한 기관을 통해 데이터에 접근하고 있다는 뜻 => 데이터를 해독해 사용해도 됨
    - 웹 푸시와 관련한 소스 자료
        - The Service Worker Cookbook
            - PWA의 서비스 워커와 관련해서 실전에서 활용할 만한 다양한 예제를 소스, 데모와 함께 제공
        - Notification Generator : 푸시 알림의 디테일한 표현과 테스트
            - 비주얼한 설정을 선택하고 바로 알림을 받아볼 수 있음